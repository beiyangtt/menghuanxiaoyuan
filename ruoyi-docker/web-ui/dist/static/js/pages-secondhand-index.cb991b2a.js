(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-secondhand-index"],{"068d":function(e,t,a){"use strict";a.r(t);var o=a("6c6f"),n=a.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(r);t["default"]=n.a},2104:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o}));var o={uniSearchBar:a("0293").default,uniIcons:a("b1c9").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"container"},[a("v-uni-view",{staticClass:"search-bar"},[a("uni-search-bar",{attrs:{placeholder:"搜索商品...",clearButton:"auto"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSearch.apply(void 0,arguments)},clear:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClearSearch.apply(void 0,arguments)}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}})],1),a("v-uni-view",{staticClass:"category-tabs"},e._l(e.categories,(function(t){return a("v-uni-view",{key:t.categoryId,staticClass:"tab-item",class:{active:e.currentCategory===t.categoryId},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.switchCategory(t.categoryId)}}},[e._v(" "+e._s(t.categoryName)+" ")])})),1),a("v-uni-view",{staticClass:"goods-list"},[e.loading?a("v-uni-view",{staticClass:"loading-text"},[e._v("加载中...")]):0===e.goodsList.length?a("v-uni-view",{staticClass:"empty-text"},[e._v("暂无商品")]):e._l(e.goodsList,(function(t){return a("v-uni-view",{key:t.id,staticClass:"goods-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.navigateToDetail(t.id,t.status)}}},[a("v-uni-view",{staticClass:"goods-image-wrapper"},[t.image?a("v-uni-image",{staticClass:"goods-image",attrs:{src:t.image,mode:"aspectFill"}}):a("v-uni-view",{staticClass:"goods-image-placeholder"},[a("uni-icons",{attrs:{type:"image",size:"40",color:"#ddd"}}),a("v-uni-text",{staticClass:"placeholder-text"},[e._v("暂无图片")])],1)],1),a("v-uni-view",{staticClass:"goods-info"},[a("v-uni-text",{staticClass:"goods-title"},[e._v(e._s(t.title))]),a("v-uni-view",{staticClass:"goods-meta"},[a("v-uni-text",{staticClass:"goods-price"},[e._v("¥"+e._s(t.price))]),"1"===t.status?a("v-uni-view",{staticClass:"sold-badge"},[a("v-uni-text",{staticClass:"sold-text"},[e._v("已售出")])],1):e._e(),a("v-uni-text",{staticClass:"goods-time"},[e._v(e._s(t.time))])],1),a("v-uni-view",{staticClass:"goods-tags"},e._l(t.tags,(function(t){return a("v-uni-text",{key:t,staticClass:"tag"},[e._v(e._s(t))])})),1)],1)],1)}))],2),a("v-uni-view",{staticClass:"fab-button",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.navigateToPublish.apply(void 0,arguments)}}},[a("uni-icons",{attrs:{type:"plus",size:"30",color:"#fff"}})],1)],1)},r=[]},"30f7":function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},a("7a76"),a("c9b5")},4733:function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(Array.isArray(e))return(0,o.default)(e)};var o=function(e){return e&&e.__esModule?e:{default:e}}(a("8d0b"))},"65f1":function(e,t,a){"use strict";var o=a("7947"),n=a.n(o);n.a},"6c6f":function(e,t,a){"use strict";a("6a54");var o=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("bf0f"),a("18f7"),a("de6c"),a("c223"),a("fd3c"),a("0c26"),a("8f71");var n=o(a("b7c7")),r=o(a("2634")),i=o(a("2fdc")),d=a("dc11"),s=a("d0b6"),c={data:function(){return{currentCategory:0,categories:[{categoryId:0,categoryName:"全部"}],goodsList:[],searchKeyword:"",loading:!1,hasEntered:!1}},onLoad:function(){this.loadCategories(),this.loadGoodsList()},onShow:function(){this.hasEntered?this.loadGoodsList():this.hasEntered=!0},onPullDownRefresh:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([e.loadCategories(),e.loadGoodsList()]);case 3:return t.prev=3,uni.stopPullDownRefresh(),t.finish(3);case 6:case"end":return t.stop()}}),t,null,[[0,,3,6]])})))()},methods:{loadCategories:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var a;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,d.getCategoryList)();case 3:a=t.sent,200===a.code&&(e.categories=[{categoryId:0,categoryName:"全部"}].concat((0,n.default)(a.data))),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("加载分类失败:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},loadGoodsList:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var a,o;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,a={},e.currentCategory>0&&(a.categoryId=e.currentCategory),e.searchKeyword&&(a.goodsTitle=e.searchKeyword),t.next=7,(0,d.getGoodsList)(a);case 7:o=t.sent,200===o.code&&(e.goodsList=o.rows||[],e.goodsList=e.goodsList.map((function(t){var a=null;if(t.images&&t.images.trim()){var o=t.images.split(",").filter((function(e){return e&&e.trim()}));o.length>0&&(a=(0,s.resolveFileUrl)(o[0]))}return{id:t.goodsId,title:t.goodsTitle,price:t.goodsPrice,image:a,status:t.goodsStatus||"0",time:e.formatTime(t.createTime),tags:"0"===t.goodsStatus?["待售"]:[]}}))),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](1),console.error("加载商品列表失败:",t.t0),uni.showToast({title:"加载失败，请重试",icon:"none"});case 15:return t.prev=15,e.loading=!1,t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[1,11,15,18]])})))()},handleSearch:function(e){this.searchKeyword=e.value||"",this.loadGoodsList()},handleClearSearch:function(){this.searchKeyword="",this.loadGoodsList()},switchCategory:function(e){this.currentCategory=e,this.loadGoodsList()},navigateToDetail:function(e,t){uni.navigateTo({url:"/pages/secondhand/detail?id=".concat(e)})},navigateToPublish:function(){uni.navigateTo({url:"/pages/secondhand/publish"})},formatTime:function(e){return(0,s.formatRelativeTime)(e)}}};t.default=c},7947:function(e,t,a){var o=a("e1f9");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var n=a("967d").default;n("6620c6b0",o,!0,{sourceMap:!1,shadowMode:!1})},b7c7:function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e)||(0,n.default)(e)||(0,r.default)(e)||(0,i.default)()};var o=d(a("4733")),n=d(a("d14d")),r=d(a("5d6b")),i=d(a("30f7"));function d(e){return e&&e.__esModule?e:{default:e}}},d14d:function(e,t,a){"use strict";a("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},a("01a2"),a("e39c"),a("bf0f"),a("844d"),a("18f7"),a("de6c"),a("08eb")},dc11:function(e,t,a){"use strict";a("6a54");var o=a("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.addGoods=function(e){return(0,n.default)({url:"/dreamcampus/secondhand",method:"post",data:e})},t.completeTrade=function(e){return(0,n.default)({url:"/dreamcampus/secondhand/complete/"+e,method:"put"})},t.deleteGoods=function(e){return(0,n.default)({url:"/dreamcampus/secondhand/"+e,method:"delete"})},t.getCategoryList=function(){return(0,n.default)({url:"/dreamcampus/secondhand/category/list",method:"get"})},t.getFavoriteCount=function(){return(0,n.default)({url:"/dreamcampus/secondhand/favorite/count",method:"get"})},t.getFavoriteList=function(){return(0,n.default)({url:"/dreamcampus/secondhand/favorite/list",method:"get"})},t.getGoodsDetail=function(e){return(0,n.default)({url:"/dreamcampus/secondhand/"+e,method:"get"})},t.getGoodsList=function(e){return(0,n.default)({url:"/dreamcampus/secondhand/list",method:"get",params:e})},t.getHotGoods=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;return(0,n.default)({url:"/dreamcampus/secondhand/hot",method:"get",params:{limit:e}})},t.getMyGoodsCount=function(){return(0,n.default)({url:"/dreamcampus/secondhand/my/count",method:"get"})},t.getMyGoodsList=function(){return(0,n.default)({url:"/dreamcampus/secondhand/my/list",method:"get"})},t.getMyOrderList=function(){return(0,n.default)({url:"/dreamcampus/secondhand/order/my/list",method:"get"})},t.updateGoods=function(e){return(0,n.default)({url:"/dreamcampus/secondhand",method:"put",data:e})};var n=o(a("4fad"))},e1f9:function(e,t,a){var o=a("c86c");t=o(!1),t.push([e.i,".container[data-v-434e9208]{background-color:#f5f5f5;min-height:100vh;padding-bottom:%?100?%}.search-bar[data-v-434e9208]{background-color:#fff;padding:%?20?%}.category-tabs[data-v-434e9208]{display:flex;flex-direction:row;background-color:#fff;padding:%?20?%;overflow-x:auto;white-space:nowrap}.tab-item[data-v-434e9208]{padding:%?10?% %?30?%;margin-right:%?20?%;border-radius:%?30?%;background-color:#f0f0f0;color:#666;font-size:%?28?%}.tab-item.active[data-v-434e9208]{background-color:#409eff;color:#fff}.goods-list[data-v-434e9208]{padding:%?20?%}.goods-item[data-v-434e9208]{background-color:#fff;border-radius:%?20?%;margin-bottom:%?20?%;display:flex;flex-direction:row;padding:%?20?%;box-shadow:0 %?2?% %?10?% rgba(0,0,0,.1);position:relative}.goods-image-wrapper[data-v-434e9208]{position:relative;width:%?200?%;height:%?200?%;margin-right:%?20?%}.goods-image[data-v-434e9208]{width:%?200?%;height:%?200?%;border-radius:%?10?%}.goods-image-placeholder[data-v-434e9208]{width:%?200?%;height:%?200?%;border-radius:%?10?%;background-color:#f5f5f5;display:flex;flex-direction:column;align-items:center;justify-content:center;border:%?1?% dashed #ddd}.placeholder-text[data-v-434e9208]{font-size:%?22?%;color:#999;margin-top:%?10?%}.sold-badge[data-v-434e9208]{width:%?140?%;height:%?140?%;background-color:#e5e5e5;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 %?20?%;flex-shrink:0}.sold-text[data-v-434e9208]{color:#f56c6c;font-size:%?28?%;font-weight:700;-webkit-transform:rotate(-8deg);transform:rotate(-8deg);letter-spacing:%?2?%}.goods-info[data-v-434e9208]{flex:1;display:flex;flex-direction:column;justify-content:space-between}.goods-title[data-v-434e9208]{font-size:%?30?%;color:#333;margin-bottom:%?10?%;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.goods-meta[data-v-434e9208]{display:flex;justify-content:space-between;align-items:center;margin-top:%?20?%;flex-wrap:wrap}.goods-price[data-v-434e9208]{font-size:%?36?%;color:#f56c6c;font-weight:700}.goods-time[data-v-434e9208]{font-size:%?24?%;color:#999}.goods-tags[data-v-434e9208]{display:flex;flex-direction:row;margin-top:%?10?%}.tag[data-v-434e9208]{font-size:%?20?%;color:#409eff;background-color:#ecf5ff;padding:%?4?% %?10?%;border-radius:%?4?%;margin-right:%?10?%}.fab-button[data-v-434e9208]{position:fixed;right:%?40?%;bottom:%?120?%;width:%?100?%;height:%?100?%;border-radius:50%;background-color:#409eff;display:flex;align-items:center;justify-content:center;box-shadow:0 %?4?% %?12?% rgba(64,158,255,.4);z-index:999}.loading-text[data-v-434e9208], .empty-text[data-v-434e9208]{text-align:center;padding:%?100?% 0;color:#999;font-size:%?28?%}",""]),e.exports=t},eab7:function(e,t,a){"use strict";a.r(t);var o=a("2104"),n=a("068d");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);a("65f1");var i=a("828b"),d=Object(i["a"])(n["default"],o["b"],o["c"],!1,null,"434e9208",null,!1,o["a"],void 0);t["default"]=d.exports}}]);